<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Hub â€“ Fundamental Analysis</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Google Fonts: Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-dark-bg: #0D1117;
            --color-glass-bg: rgba(13, 17, 23, 0.5); /* Adjusted back to semi-transparent */
            --color-glass-border: rgba(255, 255, 255, 0.1);
            --color-accent-green: #00A82D;
            --color-accent-red: #FF2E2E;
            --color-text-light: #F9FAFB;
            --color-text-muted: #A0AEC0;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--color-text-light);
            /* Making the body background semi-transparent to enhance the video */
            background-color: rgba(13, 17, 23, 0.95);
            transition: background-color 0.5s ease;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Poppins', sans-serif;
        }

        /* Background video styling to cover the entire page */
        .bg-video {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
            opacity: 0.2;
            filter: grayscale(100%);
        }

        /* Custom utility classes */
        /* Adjusted these classes back to semi-transparent */
        .bg-glass-section {
            background-color: rgba(13, 17, 23, 0.7);
            backdrop-filter: blur(10px);
        }
        .bg-glass-secondary {
            background-color: rgba(26, 33, 48, 0.7);
            backdrop-filter: blur(10px);
        }

        /* Form input styling */
        .bg-dark-secondary {
             background-color: #000 !important;
        }
        input.bg-dark-secondary,
        textarea.bg-dark-secondary,
        input.bg-dark-secondary:focus,
        textarea.bg-dark-secondary:focus {
            color: var(--color-text-light);
        }

        /* Fix for browser autofill styles overriding background */
        input:-webkit-autofill,
        input:-webkit-autofill:hover, 
        input:-webkit-autofill:focus, 
        textarea:-webkit-autofill,
        textarea:-webkit-autofill:hover,
        textarea:-webkit-autofill:focus {
            -webkit-text-fill-color: var(--color-text-light) !important;
            -webkit-box-shadow: 0 0 0px 1000px #000 inset !important; /* Black background for autofill */
            transition: background-color 5000s ease-in-out 0s;
            border: 1px solid var(--color-glass-border);
        }

        .text-accent { color: var(--color-accent-green); }
        .text-delete { color: var(--color-accent-red); }
        .border-glass { border-color: var(--color-glass-border); }

        /* Glassmorphism button styles */
        .btn-glass {
            background: rgba(0, 168, 45, 0.2);
            color: var(--color-text-light);
            border: 1px solid var(--color-glass-border);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .btn-glass:hover {
            background: rgba(0, 168, 45, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 168, 45, 0.3);
        }

        .btn-delete {
            background: rgba(255, 46, 46, 0.2);
            color: var(--color-text-light);
            border: 1px solid var(--color-glass-border);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .btn-delete:hover {
            background: rgba(255, 46, 46, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 46, 46, 0.3);
        }

        /* Sticky header and hero section styling */
        .sticky-nav {
            position: sticky;
            top: 0;
            z-index: 50;
            background-color: rgba(13, 17, 23, 0.6);
            backdrop-filter: blur(10px);
        }
        .hero-section {
            height: 85vh;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.2);
        }

        /* Navigation link hover effect */
        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--color-accent-green);
            transition: width 0.3s;
        }
        .nav-link:hover::after,
        .nav-link.active::after {
            width: 100%;
        }

        /* Glassmorphism card styling */
        .card {
            background: var(--color-glass-bg);
            border: 1px solid var(--color-glass-border);
            backdrop-filter: blur(10px);
            transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 168, 45, 0.15);
        }

        /* New hover effect for blog/file cards */
        .card-light-hover:hover {
            background: rgba(0, 168, 45, 0.1);
            box-shadow: 0 0 25px rgba(0, 168, 45, 0.2), 0 0 50px rgba(0, 168, 45, 0.1);
            border-color: rgba(0, 168, 45, 0.5);
        }

        /* Page switching logic */
        .page { display: none; }
        .page.active { display: block; }

        /* Ticker styling */
        .ticker-container {
            background-color: rgba(0, 0, 0, 0.3);
        }

        /* Modal styling */
        .modal {
            background-color: rgba(0, 0, 0, 0.8);
            display: none; /* Initially hidden */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: rgba(13, 17, 23, 0.8);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 800px;
            padding: 2rem;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* Custom Message Box specific styles */
        #message-box {
            background-color: rgba(13, 17, 23, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(15px);
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
        }

        /* Hide scrollbars for ticker container */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Animation Classes */
        .fade-in-up {
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.8s forwards;
        }
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Background Video - Replaced with the new URL -->
    <video autoplay muted loop playsinline class="bg-video">
        <source src="https://cdn.pixabay.com/video/2022/07/02/122881-726547787_large.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <!-- Live Market Ticker from TradingView -->
    <div class="ticker-container">
        <!-- TradingView Widget BEGIN -->
        <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-ticker-tape.js" async>
                {
                    "symbols": [
                        { "proName": "FOREXCOM:SPXUSD", "title": "S&P 500" },
                        { "proName": "FOREXCOM:NSXUSD", "title": "US 100" },
                        { "proName": "FX_IDC:EURUSD", "title": "EUR/USD" },
                        { "proName": "BITSTAMP:BTCUSD", "title": "Bitcoin" },
                        { "proName": "BITSTAMP:ETHUSD", "title": "Ethereum" },
                        { "description": "Apple", "proName": "NASDAQ:AAPL" },
                        { "description": "Microsoft", "proName": "NASDAQ:MSFT" },
                        { "description": "Google", "proName": "NASDAQ:GOOGL" },
                        { "description": "Amazon", "proName": "NASDAQ:AMZN" },
                        { "description": "NVIDIA", "proName": "NASDAQ:NVDA" },
                        { "description": "Tesla", "proName": "NASDAQ:TSLA" }
                    ],
                    "showSymbolLogo": true,
                    "colorTheme": "dark",
                    "isTransparent": true,
                    "displayMode": "adaptive",
                    "locale": "en"
                }
            </script>
        </div>
        <!-- TradingView Widget END -->
    </div>

    <!-- Header & Navigation -->
    <header id="header" class="sticky-nav border-b border-gray-700">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-bold text-text-light nav-link" data-page="home">
                Trading Hub<span class="text-accent"> Fundamental Analysis</span>
            </a>
            <div class="hidden md:flex items-center space-x-8" id="desktop-nav-links">
                <a href="#" class="nav-link text-text-light hover:text-accent active" data-page="home">Home</a>
                <a href="#" class="nav-link text-text-light hover:text-accent" data-page="markets">Our Markets</a>
                <a href="#" class="nav-link text-text-light hover:text-accent" data-page="blog">Fundamental Analysis Blog</a>
                <a href="#" class="nav-link text-text-light hover:text-accent" data-page="contact">Contact</a>
                <!-- Auth links will be injected here by JS -->
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-text-light focus:outline-none">
                    <i class="fas fa-bars fa-lg"></i>
                </button>
            </div>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="#" class="block py-2 text-text-light hover:text-accent" data-page="home">Home</a>
            <a href="#" class="block py-2 text-text-light hover:text-accent" data-page="markets">Our Markets</a>
            <a href="#" class="block py-2 text-text-light hover:text-accent" data-page="blog">Blog</a>
            <a href="#" class="block py-2 text-text-light hover:text-accent" data-page="contact">Contact</a>
            <!-- Mobile Auth links will be injected here by JS -->
        </div>
    </header>

    <main>
        <!-- Home Page -->
        <div id="home" class="page active">
            <!-- Hero Section -->
            <section class="hero-section text-text-light text-center">
                <div class="z-10 px-4">
                    <h1 class="text-4xl md:text-6xl font-bold mb-4 leading-tight">Trade Currencies, Commodities, <br class="hidden md:block"> Precious Metals and Global Stock Indices</h1>
                    <p class="text-lg md:text-xl max-w-3xl mx-auto text-text-muted">Unlock global markets with cutting-edge analysis and powerful insights. We provide the knowledge you need to navigate the financial world with confidence.</p>
                </div>
            </section>

            <!-- Value Proposition Section -->
            <section class="py-16 sm:py-24 bg-glass-section">
                <div class="container mx-auto px-6 text-center">
                    <div class="grid md:grid-cols-3 gap-12">
                        <div class="card p-8 rounded-2xl flex flex-col items-center border-glass transition-all duration-300 transform hover:scale-105 hover:shadow-lg">
                            <div class="bg-dark-secondary p-5 rounded-full mb-4 border border-glass">
                                <i class="fas fa-chart-line fa-2x text-accent"></i>
                            </div>
                            <h3 class="text-xl font-bold mb-2 text-text-light">In-Depth Analysis</h3>
                            <p class="text-text-muted">Access comprehensive fundamental analysis to make informed trading decisions.</p>
                        </div>
                        <div class="card p-8 rounded-2xl flex flex-col items-center border-glass transition-all duration-300 transform hover:scale-105 hover:shadow-lg">
                            <div class="bg-dark-secondary p-5 rounded-full mb-4 border border-glass">
                                <i class="fas fa-book-open fa-2x text-accent"></i>
                            </div>
                            <h3 class="text-xl font-bold mb-2 text-text-light">Educational Resources</h3>
                            <p class="text-text-muted">Learn the intricacies of the markets with our extensive blog and guides.</p>
                        </div>
                        <div class="card p-8 rounded-2xl flex flex-col items-center border-glass transition-all duration-300 transform hover:scale-105 hover:shadow-lg">
                            <div class="bg-dark-secondary p-5 rounded-full mb-4 border border-glass">
                                <i class="fas fa-globe fa-2x text-accent"></i>
                            </div>
                            <h3 class="text-xl font-bold mb-2 text-text-light">Global Market Coverage</h3>
                            <p class="text-text-muted">Explore opportunities across Forex, commodities, indices, and more.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Latest Blog Posts Section -->
            <section class="py-16 sm:py-24 bg-glass-secondary">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-text-light">Latest Blog Posts</h2>
                    <div class="overflow-x-auto hide-scrollbar pb-4">
                        <div id="latest-posts-container" class="flex space-x-8">
                            <!-- Latest blog posts will be loaded here dynamically by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Latest Market Files Section -->
            <section class="py-16 sm:py-24 bg-glass-section">
                <div class="container mx-auto px-6">
                    <h2 class="text-3xl md:text-4xl font-bold text-center mb-12 text-text-light">Latest Market Files</h2>
                    <div class="overflow-x-auto hide-scrollbar pb-4">
                        <div id="latest-files-container" class="flex space-x-8">
                            <!-- Latest files will be loaded here dynamically by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Our Markets Page -->
        <div id="markets" class="page">
            <section class="py-16 sm:py-24 bg-glass-secondary">
                <div class="container mx-auto px-6">
                    <h1 class="text-4xl md:text-5xl font-bold text-center mb-12 text-text-light">Live Market Data</h1>

                    <!-- TradingView Market Overview Widget -->
                    <div class="card p-4 sm:p-6 rounded-2xl border-glass mb-12">
                        <h2 class="text-2xl md:text-3xl font-bold text-left mb-6 text-text-light">Market Overview</h2>
                        <div class="tradingview-widget-container" style="height: 550px;">
                            <div class="tradingview-widget-container__widget"></div>
                            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-market-overview.js" async>
                            {
                                "colorTheme": "dark",
                                "dateRange": "12M",
                                "showChart": true,
                                "locale": "en",
                                "largeChartUrl": "",
                                "isTransparent": true,
                                "showSymbolLogo": true,
                                "showFloatingTooltip": false,
                                "width": "100%",
                                "height": "100%",
                                "tabs": [
                                    { "title": "Indices", "symbols": [ { "s": "FOREXCOM:SPXUSD", "d": "S&P 500" }, { "s": "FOREXCOM:NSXUSD", "d": "US 100" }, { "s": "FOREXCOM:DJI", "d": "Dow 30" }, { "s": "INDEX:NKY", "d": "Nikkei 225" }, { "s": "INDEX:DEU40", "d": "DAX 40" }, { "s": "FOREXCOM:UKXGBP", "d": "UK 100" } ], "originalTitle": "Indices" },
                                    { "title": "Forex", "symbols": [ { "s": "FX:EURUSD", "d": "EUR/USD" }, { "s": "FX:GBPUSD", "d": "GBP/USD" }, { "s": "FX:USDJPY", "d": "USD/JPY" }, { "s": "FX:USDCHF", "d": "USD/CHF" }, { "s": "FX:AUDUSD", "d": "AUD/USD" }, { "s": "FX:USDCAD", "d": "USD/CAD" } ], "originalTitle": "Forex" },
                                    { "title": "Crypto", "symbols": [ { "s": "BITSTAMP:BTCUSD", "d": "Bitcoin" }, { "s": "BITSTAMP:ETHUSD", "d": "Ethereum" }, { "s": "COINBASE:SOLUSD", "d": "Solana" }, { "s": "COINBASE:XRPUSD", "d": "Ripple" }, { "s": "COINBASE:ADAUSD", "d": "Cardano" }, { "s": "COINBASE:DOGEUSD", "d": "Dogecoin" } ], "originalTitle": "Crypto" },
                                    { "title": "Commodities", "symbols": [ { "s": "CME_MINI:ES1!", "d": "E-Mini S&P" }, { "s": "CME:6E1!", "d": "Euro" }, { "s": "COMEX:GC1!", "d": "Gold" }, { "s": "NYMEX:CL1!", "d": "Crude Oil" }, { "s": "NYMEX:NG1!", "d": "Natural Gas" }, { "s": "CBOT:ZC1!", "d": "Corn" } ], "originalTitle": "Commodities" }
                                ]
                            }
                            </script>
                        </div>
                    </div>

                    <!-- TradingView Symbol Charts -->
                    <h2 class="text-2xl md:text-3xl font-bold text-center mb-8 text-text-light">Key Instrument Charts</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mb-12">
                        <!-- S&P 500 Chart -->
                        <div class="card p-4 sm:p-6 rounded-2xl border-glass h-[400px]">
                            <div class="tradingview-widget-container" style="height:100%; width:100%">
                              <div class="tradingview-widget-container__widget"></div>
                              <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js" async>
                              { "symbols": [ [ "S&P 500", "FOREXCOM:SPXUSD|1D" ] ], "chartOnly": false, "width": "100%", "height": "100%", "locale": "en", "colorTheme": "dark", "autosize": true, "showVolume": false, "showMA": false, "hideDateRanges": false, "hideMarketStatus": false, "hideSymbolLogo": false, "scalePosition": "right", "scaleMode": "Normal", "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif", "fontSize": "10", "noTimeScale": false, "valuesTracking": "1", "changeMode": "price-and-percent", "chartType": "area", "maLineColor": "#2962FF", "maLineWidth": 1, "maLength": 9, "lineWidth": 2, "lineType": 0, "dateRanges": [ "1d", "1m", "3m", "1y", "5y", "all" ], "isTransparent": true }
                              </script>
                            </div>
                        </div>
                        <!-- Bitcoin Chart -->
                        <div class="card p-4 sm:p-6 rounded-2xl border-glass h-[400px]">
                            <div class="tradingview-widget-container" style="height:100%; width:100%">
                              <div class="tradingview-widget-container__widget"></div>
                              <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js" async>
                              { "symbols": [ [ "Bitcoin", "BITSTAMP:BTCUSD|1D" ] ], "chartOnly": false, "width": "100%", "height": "100%", "locale": "en", "colorTheme": "dark", "autosize": true, "showVolume": false, "showMA": false, "hideDateRanges": false, "hideMarketStatus": false, "hideSymbolLogo": false, "scalePosition": "right", "scaleMode": "Normal", "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif", "fontSize": "10", "noTimeScale": false, "valuesTracking": "1", "changeMode": "price-and-percent", "chartType": "area", "maLineColor": "#2962FF", "maLineWidth": 1, "maLength": 9, "lineWidth": 2, "lineType": 0, "dateRanges": [ "1d", "1m", "3m", "1y", "5y", "all" ], "isTransparent": true }
                              </script>
                            </div>
                        </div>
                        <!-- EUR/USD Chart -->
                        <div class="card p-4 sm:p-6 rounded-2xl border-glass h-[400px]">
                           <div class="tradingview-widget-container" style="height:100%; width:100%">
                              <div class="tradingview-widget-container__widget"></div>
                              <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js" async>
                              { "symbols": [ [ "EUR/USD", "FX:EURUSD|1D" ] ], "chartOnly": false, "width": "100%", "height": "100%", "locale": "en", "colorTheme": "dark", "autosize": true, "showVolume": false, "showMA": false, "hideDateRanges": false, "hideMarketStatus": false, "hideSymbolLogo": false, "scalePosition": "right", "scaleMode": "Normal", "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif", "fontSize": "10", "noTimeScale": false, "valuesTracking": "1", "changeMode": "price-and-percent", "chartType": "area", "maLineColor": "#2962FF", "maLineWidth": 1, "maLength": 9, "lineWidth": 2, "lineType": 0, "dateRanges": [ "1d", "1m", "3m", "1y", "5y", "all" ], "isTransparent": true }
                              </script>
                            </div>
                        </div>
                    </div>

                    <!-- TradingView Economic Calendar Widget -->
                    <div class="card p-4 sm:p-6 rounded-2xl border-glass mb-16">
                        <h2 class="text-2xl md:text-3xl font-bold text-left mb-6 text-text-light">Economic Calendar</h2>
                        <div class="tradingview-widget-container" style="height: 600px;">
                            <div class="tradingview-widget-container__widget"></div>
                            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-events.js" async>
                            { "colorTheme": "dark", "isTransparent": true, "width": "100%", "height": "100%", "locale": "en", "importanceFilter": "-1,0,1" }
                            </script>
                        </div>
                    </div>

                    <!-- File Download Section -->
                    <div>
                        <h2 class="text-4xl md:text-5xl font-bold text-center mb-4 text-text-light">Market Analysis & Resources</h2>
                        <p class="text-lg text-text-muted text-center max-w-3xl mx-auto mb-16">Download our latest analysis files to stay ahead of the markets.</p>
                        <div id="market-files-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                            <!-- Market files will be loaded here dynamically by JavaScript -->
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Blog Page -->
        <div id="blog" class="page">
            <!-- Adjusted back to semi-transparent glassmorphism class -->
            <section class="py-16 sm:py-24 bg-glass-section">
                <div class="container mx-auto px-6">
                    <h1 class="text-4xl md:text-5xl font-bold text-center mb-12 text-text-light">Fundamental Analysis Blog</h1>
                    <div id="blog-posts-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <!-- Blog posts will be loaded here dynamically by JavaScript -->
                    </div>
                </div>
            </section>
        </div>

        <!-- Contact Page -->
        <div id="contact" class="page">
            <!-- Adjusted back to semi-transparent glassmorphism class -->
            <section class="py-16 sm:py-24 bg-glass-secondary">
                <div class="container mx-auto px-6">
                    <div class="text-center">
                        <h1 class="text-4xl md:text-5xl font-bold text-text-light">Get In Touch</h1>
                        <p class="text-lg text-text-muted mt-4 max-w-2xl mx-auto">Have a question, suggestion, or feedback? We'd love to hear from you.</p>
                    </div>
                    <div class="mt-16 max-w-4xl mx-auto grid md:grid-cols-2 gap-12">
                        <!-- Contact Form -->
                        <div class="card p-8 rounded-2xl border-glass">
                            <h2 class="text-2xl font-bold text-text-light mb-6">Send us a Message</h2>
                            <form id="contact-form">
                                <div class="mb-4">
                                    <label for="name" class="block text-text-muted mb-2">Name</label>
                                    <input type="text" id="name" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                                </div>
                                <div class="mb-4">
                                    <label for="email" class="block text-text-muted mb-2">Email</label>
                                    <input type="email" id="email" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                                </div>
                                <div class="mb-6">
                                    <label for="message" class="block text-text-muted mb-2">Message</label>
                                    <textarea id="message" rows="5" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required></textarea>
                                </div>
                                <button type="submit" class="btn-glass font-bold w-full py-3 rounded-xl">Submit</button>
                                <p id="form-status" class="text-center mt-4"></p>
                            </form>
                        </div>
                        <!-- Contact Info -->
                        <div class="space-y-8">
                            <div class="card p-8 rounded-2xl border-glass">
                                <h3 class="text-xl font-bold mb-4">Contact Information</h3>
                                <ul class="space-y-4 text-text-muted">
                                    <li class="flex items-center"><i class="fas fa-envelope mr-3 text-accent"></i> support@tradinghub.com</li>
                                    <li class="flex items-center"><i class="fas fa-phone mr-3 text-accent"></i> +44 7458 157780</li>
                                    <li class="flex items-center"><i class="fas fa-map-marker-alt mr-3 text-accent"></i> 123 Trading Lane, London, UK</li>
                                </ul>
                            </div>
                            <div class="card p-8 rounded-2xl border-glass">
                                <h3 class="text-xl font-bold mb-4">Business Hours</h3>
                                <p class="text-text-muted">Monday - Friday: 9:00 AM - 5:00 PM GMT</p>
                                <p class="text-text-muted">Saturday, Sunday: Closed</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Admin Dashboard Page -->
        <div id="admin" class="page">
            <!-- Adjusted back to semi-transparent glassmorphism class -->
            <section class="py-16 sm:py-24 bg-glass-secondary">
                <div class="container mx-auto px-6">
                    <h1 class="text-4xl font-bold text-center mb-12">Admin Dashboard</h1>
                    <!-- Blog Management -->
                    <div class="max-w-2xl mx-auto card p-8 rounded-2xl border-glass">
                        <h2 class="text-2xl font-bold mb-6">Create New Post</h2>
                        <form id="create-post-form">
                            <!-- Form fields for blog post -->
                            <div class="mb-4">
                                <label for="post-title" class="block mb-2 text-accent">Title</label>
                                <input type="text" id="post-title" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                            </div>
                            <div class="mb-4">
                                <label for="post-image-url" class="block mb-2 text-accent">Image URL</label>
                                <input type="url" id="post-image-url" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                            </div>
                            <div class="mb-6">
                                <label for="post-content" class="block mb-2 text-accent">Content (Excerpt)</label>
                                <textarea id="post-content" rows="5" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required></textarea>
                            </div>
                            <button type="submit" class="btn-glass font-bold w-full py-3 rounded-xl">Publish Post</button>
                        </form>
                    </div>
                    <div class="mt-8 max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-center mb-8">Manage Posts</h2>
                        <div id="manage-posts-container" class="space-y-4"></div>
                    </div>

                    <!-- File Upload Section -->
                    <div class="max-w-2xl mx-auto card p-8 rounded-2xl border-glass mt-16">
                        <h2 class="text-2xl font-bold mb-6">Upload Market File</h2>
                        <form id="upload-file-form">
                            <div class="mb-4">
                                <label for="file-title" class="block mb-2 text-accent">File Title</label>
                                <input type="text" id="file-title" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                            </div>
                            <div class="mb-6">
                                <label for="file-upload" class="block mb-2 text-accent">Select File (PDF, XLS, etc.)</label>
                                <input type="file" id="file-upload" class="w-full text-text-light" required>
                            </div>
                            <button type="submit" class="btn-glass font-bold w-full py-3 rounded-xl">Upload File</button>
                        </form>
                    </div>
                    <div class="mt-8 max-w-4xl mx-auto">
                        <h2 class="text-2xl font-bold text-center mb-8">Manage Files</h2>
                        <div id="manage-files-container" class="space-y-4"></div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Blog Post Modal -->
    <div id="post-modal" class="modal">
        <div class="modal-content rounded-2xl">
            <button id="close-post-modal" class="absolute top-4 right-4 text-text-muted hover:text-text-light text-2xl">&times;</button>
            <img id="post-modal-image" class="w-full h-auto max-h-96 object-cover rounded-xl mb-6" alt="Post Image" onerror="this.onerror=null;this.src='https://placehold.co/800x400/1E1E1E/B8860B?text=Image+Not+Found';">
            <h2 id="post-modal-title" class="text-3xl font-bold mb-4"></h2>
            <p id="post-modal-content" class="text-text-muted text-lg leading-relaxed"></p>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content w-full max-w-md p-8 rounded-2xl border-glass relative">
            <button id="close-login-modal" class="absolute top-4 right-4 text-text-muted hover:text-text-light text-2xl">&times;</button>
            <h2 class="text-2xl font-bold text-center mb-6">Admin Login</h2>
            <form id="login-form">
                <div class="mb-4">
                    <label for="login-email" class="block text-text-muted mb-2">Email</label>
                    <input type="email" id="login-email" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                </div>
                <div class="mb-6">
                    <label for="login-password" class="block text-text-muted mb-2">Password</label>
                    <input type="password" id="login-password" class="w-full bg-dark-secondary border border-glass rounded-lg p-2" required>
                </div>
                <button type="submit" class="btn-glass font-bold w-full py-3 rounded-xl">Login</button>
                <p id="login-error" class="text-delete text-center mt-4"></p>
            </form>
        </div>
    </div>

    <!-- Custom Message Box (Replaces native alert/confirm) -->
    <div id="message-box" class="fixed inset-0 z-50 items-center justify-center hidden">
        <div class="bg-dark-secondary p-8 rounded-2xl max-w-md w-full border border-glass text-center relative">
            <p id="message-text" class="text-text-light mb-6"></p>
            <div id="message-actions" class="flex justify-center space-x-4">
                <button id="message-ok" class="btn-glass px-6 py-2 rounded-xl">OK</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-glass-section border-t border-glass">
        <div class="container mx-auto px-6 py-12">
            <div class="grid md:grid-cols-4 gap-8">
                <!-- About -->
                <div class="col-span-1">
                    <h3 class="text-xl font-bold text-text-light mb-4">Trading<span class="text-accent">Hub</span></h3>
                    <p class="text-text-muted">Providing in-depth fundamental analysis for the modern trader.</p>
                </div>
                <!-- Links -->
                <div>
                    <h4 class="font-bold text-text-light mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-text-muted hover:text-accent" data-page="home">Home</a></li>
                        <li><a href="#" class="text-text-muted hover:text-accent" data-page="markets">Our Markets</a></li>
                        <li><a href="#" class="text-text-muted hover:text-accent" data-page="blog">Blog</a></li>
                        <li><a href="#" class="text-text-muted hover:text-accent" data-page="contact">Contact</a></li>
                    </ul>
                </div>
                <!-- Contact Info -->
                <div>
                    <h4 class="font-bold text-text-light mb-4">Contact</h4>
                    <ul class="space-y-2 text-text-muted">
                        <li><i class="fas fa-envelope mr-2 text-accent"></i> support@tradinghub.com</li>
                        <li><i class="fas fa-phone mr-2 text-accent"></i> +44 7458 157780</li>
                    </ul>
                </div>
                <!-- Socials -->
                <div>
                    <h4 class="font-bold text-text-light mb-4">Follow Us</h4>
                    <div class="flex space-x-4">
                        <a href="#" class="text-text-muted hover:text-accent"><i class="fab fa-twitter fa-lg"></i></a>
                        <a href="#" class="text-text-muted hover:text-accent"><i class="fab fa-linkedin fa-lg"></i></a>
                        <a href="#" class="text-text-muted hover:text-accent"><i class="fab fa-youtube fa-lg"></i></a>
                    </div>
                </div>
            </div>
            <!-- Disclaimer -->
            <div class="mt-12 pt-8 border-t border-glass">
                <h4 class="font-bold text-text-light mb-2">Disclaimer</h4>
                <p class="text-xs text-text-muted mb-4">Trading Hub provides educational and analytical content for informational purposes only. The information on this site is not intended to be, and does not constitute, financial advice or any other advice. Trading foreign exchange, commodities, and other financial instruments on margin carries a high level of risk and may not be suitable for all investors. Before deciding to trade, you should carefully consider your investment objectives, level of experience, and risk appetite.</p>
                <div class="text-center text-text-muted text-sm">
                    <span>&copy; 2024 Trading Hub. All Rights Reserved.</span> |
                    <a href="#" class="hover:text-accent">Privacy Policy</a> |
                    <a href="#" class="hover:text-accent">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- WhatsApp Chat Icon -->
    <a href="https://wa.me/447458157780" target="_blank" class="fixed bottom-6 right-6 bg-green-500 text-text-light w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:bg-green-600 transition-all">
        <i class="fab fa-whatsapp fa-2x"></i>
    </a>

    <script type="module">
        // Import Supabase client from CDN
        import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.43.2/+esm";

        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const pages = document.querySelectorAll('.page');
            const desktopNav = document.getElementById('desktop-nav-links');
            const mobileNav = document.getElementById('mobile-menu');
            const loginModal = document.getElementById('login-modal');
            const closeLoginModalButton = document.getElementById('close-login-modal');
            const loginForm = document.getElementById('login-form');
            const createPostForm = document.getElementById('create-post-form');
            const blogPostsContainer = document.getElementById('blog-posts-container');
            const managePostsContainer = document.getElementById('manage-posts-container');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const latestPostsContainer = document.getElementById('latest-posts-container');
            const latestFilesContainer = document.getElementById('latest-files-container');
            const uploadFileForm = document.getElementById('upload-file-form');
            const fileTitleInput = document.getElementById('file-title');
            const fileUploadInput = document.getElementById('file-upload');
            const manageFilesContainer = document.getElementById('manage-files-container');
            const marketFilesContainer = document.getElementById('market-files-container');
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');
            const messageActions = document.getElementById('message-actions');
            const postModal = document.getElementById('post-modal');
            const closePostModalButton = document.getElementById('close-post-modal');
            const postModalTitle = document.getElementById('post-modal-title');
            const postModalContent = document.getElementById('post-modal-content');
            const postModalImage = document.getElementById('post-modal-image');

            // --- Navigation Function ---
            // Handles page visibility and updates active nav links
            function switchPage(pageId) {
                pages.forEach(page => page.classList.remove('active'));
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.classList.add('active');
                    // Trigger animations for the new page's cards
                    const pageCards = targetPage.querySelectorAll('.card');
                    pageCards.forEach((card, index) => {
                        card.style.animationDelay = `${index * 0.1}s`;
                        card.classList.add('fade-in-up');
                    });
                }

                // Update active class on nav links
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                document.querySelectorAll(`a[data-page="${pageId}"]`).forEach(l => l.classList.add('active'));

                // Hide mobile menu after selection
                mobileNav.classList.add('hidden');
                // Scroll to the top of the page
                window.scrollTo(0, 0);
            }

            // --- UI Initialization & Event Listeners ---
            function initializeUI() {
                // Use event delegation for nav links
                document.body.addEventListener('click', (e) => {
                    const targetLink = e.target.closest('a[data-page]');
                    if (targetLink) {
                        e.preventDefault();
                        switchPage(targetLink.dataset.page);
                    }
                });

                // Mobile menu button toggle
                if (mobileMenuButton && mobileNav) {
                    mobileMenuButton.addEventListener('click', () => mobileNav.classList.toggle('hidden'));
                }

                // Close login modal button
                if (closeLoginModalButton) {
                    closeLoginModalButton.addEventListener('click', () => loginModal.style.display = 'none');
                }

                // Close post modal button
                if (closePostModalButton) {
                    closePostModalButton.addEventListener('click', () => postModal.style.display = 'none');
                }
            }

            // Function to add the fade-in-up animation on scroll
            function animateCards(containerId) {
                const container = document.getElementById(containerId);
                if (container) {
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                const cards = entry.target.querySelectorAll('.card');
                                cards.forEach((card, index) => {
                                    card.style.animationDelay = `${index * 0.1}s`;
                                    card.classList.add('fade-in-up');
                                });
                                observer.unobserve(entry.target);
                            }
                        });
                    }, { threshold: 0.1 });
                    observer.observe(container);
                }
            }

            // Custom Message Box functions (Replaces native alert/confirm)
            function showMessage(message, isConfirm = false) {
                return new Promise((resolve) => {
                    messageText.textContent = message;
                    messageActions.innerHTML = '';

                    const okButton = document.createElement('button');
                    okButton.textContent = 'OK';
                    okButton.className = 'btn-glass px-6 py-2 rounded-xl';
                    okButton.onclick = () => {
                        messageBox.classList.add('hidden');
                        resolve(true);
                    };
                    messageActions.appendChild(okButton);

                    if (isConfirm) {
                        const cancelButton = document.createElement('button');
                        cancelButton.textContent = 'Cancel';
                        cancelButton.className = 'btn-glass px-6 py-2 rounded-xl';
                        cancelButton.onclick = () => {
                            messageBox.classList.add('hidden');
                            resolve(false);
                        };
                        messageActions.appendChild(cancelButton);
                    }

                    messageBox.classList.remove('hidden');
                });
            }

            // --- Supabase Initialization & Logic ---
            function initializeSupabase() {
                try {
                    // NOTE: Replace with your actual Supabase URL and Anon Key
                    const SUPABASE_URL = 'https://jdjrpaefuzyhcjiwrefi.supabase.co';
                    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpkanJwYWVmdXp5aGNqaXdyZWZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU1MzI4ODUsImV4cCI6MjA3MTEwODg4NX0._jadukAG6A33VVB2ENeQ1aydh02hjEsLbVwEDRx7Bbs';

                    const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

                    let currentUser = null;
                    const ADMIN_EMAIL = "admin@tradinghub.com";

                    // Function to update the navigation UI based on user authentication state
                    function updateNavUI(user) {
                        const isAdmin = user && user.email === ADMIN_EMAIL;
                        // Check for admin query parameter in URL
                        const urlParams = new URLSearchParams(window.location.search);
                        const showLogin = urlParams.get('admin') === 'true';

                        // Remove old auth links
                        desktopNav.querySelectorAll('.auth-link').forEach(el => el.remove());
                        mobileNav.querySelectorAll('.auth-link').forEach(el => el.remove());

                        let desktopLinks = '', mobileLinks = '';

                        if (user) {
                            // If user is logged in
                            if (isAdmin) {
                                desktopLinks += `<a href="#" class="nav-link text-text-light hover:text-accent auth-link" data-page="admin">Admin</a>`;
                                mobileLinks += `<a href="#" class="block py-2 text-text-light hover:text-accent auth-link" data-page="admin">Admin</a>`;
                            }
                            desktopLinks += `<a href="#" id="logout-btn" class="nav-link text-text-light hover:text-accent auth-link">Logout</a>`;
                            mobileLinks += `<a href="#" id="mobile-logout-btn" class="block py-2 text-text-light hover:text-accent auth-link">Logout</a>`;
                        } else if (showLogin) {
                            // If no user is logged in AND admin=true is in the URL
                            desktopLinks += `<a href="#" id="login-btn" class="nav-link text-text-light hover:text-accent auth-link">Login</a>`;
                            mobileLinks += `<a href="#" id="mobile-login-btn" class="block py-2 text-text-light hover:text-accent auth-link">Login</a>`;
                        }

                        desktopNav.insertAdjacentHTML('beforeend', desktopLinks);
                        mobileNav.insertAdjacentHTML('beforeend', mobileLinks);

                        // Attach event listeners to the newly created buttons
                        document.getElementById('login-btn')?.addEventListener('click', (e) => {
                            e.preventDefault();
                            loginModal.style.display = 'flex';
                        });
                        document.getElementById('mobile-login-btn')?.addEventListener('click', (e) => {
                            e.preventDefault();
                            loginModal.style.display = 'flex';
                        });
                        document.getElementById('logout-btn')?.addEventListener('click', (e) => {
                            e.preventDefault();
                            handleLogout();
                        });
                        document.getElementById('mobile-logout-btn')?.addEventListener('click', (e) => {
                            e.preventDefault();
                            handleLogout();
                        });
                    }

                    // Listen for auth state changes and update UI
                    supabaseClient.auth.onAuthStateChange((event, session) => {
                        currentUser = session?.user ?? null;
                        updateNavUI(currentUser);
                    });

                    // Handle admin login form submission
                    loginForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        const email = document.getElementById('login-email').value;
                        const password = document.getElementById('login-password').value;
                        const errorEl = document.getElementById('login-error');
                        errorEl.textContent = '';

                        const { error } = await supabaseClient.auth.signInWithPassword({ email, password });

                        if (error) {
                            console.error("Login failed:", error);
                            errorEl.textContent = "Invalid email or password.";
                        } else {
                            loginModal.style.display = 'none';
                            loginForm.reset();
                        }
                    });

                    // Handle logout
                    async function handleLogout() {
                        await supabaseClient.auth.signOut();
                        // Redirect to the base URL without the admin parameter after logout
                        window.location.href = window.location.pathname;
                    }

                    // --- Blog Logic ---
                    // Handle new blog post creation
                    createPostForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        if (!currentUser || currentUser.email !== ADMIN_EMAIL) {
                            showMessage("You are not authorized to publish posts.");
                            return;
                        }
                        const title = document.getElementById('post-title').value;
                        const imageUrl = document.getElementById('post-image-url').value;
                        const content = document.getElementById('post-content').value;

                        const { error } = await supabaseClient.from('posts').insert([{ title, imageUrl, content }]);
                        if (error) console.error("Error adding post:", error);
                        else createPostForm.reset();
                    });

                    // Renders blog posts and manages the UI for all post-related sections
                    function renderPosts(posts) {
                        let blogHtml = '', manageHtml = '', latestPostsHtml = '';
                        if (!posts || posts.length === 0) {
                            const noPostsMsg = `<p class="text-center col-span-full text-text-muted">No blog posts yet.</p>`;
                            blogHtml = noPostsMsg;
                            manageHtml = `<p class="text-center text-text-muted">No posts to manage.</p>`;
                            latestPostsHtml = `<p class="text-center col-span-full text-text-muted">No latest posts yet.</p>`;
                        } else {
                            // Render latest posts on the homepage
                            const latestPosts = posts.slice(0, 5); // Get the 5 latest posts
                            latestPosts.forEach(post => {
                                latestPostsHtml += `<a href="#" data-page="blog" class="block w-64 flex-shrink-0 card card-light-hover rounded-2xl overflow-hidden">
                                    <img src="${post.imageUrl}" alt="${post.title}" class="w-full h-32 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/400x200/1E1E1E/B8860B?text=Image+Not+Found';">
                                    <div class="p-4"><h4 class="text-md font-bold text-text-light truncate">${post.title}</h4></div>
                                </a>`;
                            });

                            // Render all posts on the blog page and admin manage page
                            posts.forEach(post => {
                                // Blog page display
                                blogHtml += `<div class="card rounded-2xl overflow-hidden flex flex-col">
                                    <img src="${post.imageUrl}" alt="${post.title}" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/1E1E1E/B8860B?text=Image+Not+Found';">
                                    <div class="p-6 flex flex-col flex-grow">
                                        <h3 class="text-xl font-bold text-text-light mb-2">${post.title}</h3>
                                        <p class="text-text-muted mb-4 flex-grow">${post.content}</p>
                                        <a href="#" data-post-id="${post.id}" class="read-more-btn btn-glass font-bold py-2 px-4 rounded-xl text-center mt-auto">Read More</a>
                                    </div>
                                </div>`;
                                // Admin manage page display
                                manageHtml += `<div class="card p-4 rounded-2xl flex justify-between items-center border-glass">
                                    <span class="truncate pr-4">${post.title}</span>
                                    <button data-id="${post.id}" class="delete-post-btn text-delete hover:text-accent font-bold">Delete</button>
                                </div>`;
                            });
                        }
                        blogPostsContainer.innerHTML = blogHtml;
                        managePostsContainer.innerHTML = manageHtml;
                        latestPostsContainer.innerHTML = latestPostsHtml;

                        // Add event listeners for the delete buttons
                        document.querySelectorAll('.delete-post-btn').forEach(button => {
                            button.addEventListener('click', async (e) => {
                                const confirmDelete = await showMessage("Are you sure you want to delete this post?", true);
                                if (confirmDelete) {
                                    const { error } = await supabaseClient.from('posts').delete().match({ id: e.target.dataset.id });
                                    if (error) console.error("Error deleting post:", error);
                                }
                            });
                        });

                        // Add event listeners for "Read More" buttons to open the modal
                        document.querySelectorAll('.read-more-btn').forEach(button => {
                            button.addEventListener('click', async (e) => {
                                e.preventDefault();
                                const postId = e.target.dataset.postId;
                                const { data: post, error } = await supabaseClient.from('posts').select('*').eq('id', postId).single();
                                if (error) {
                                    console.error("Error fetching post:", error);
                                    showMessage("Failed to load post.");
                                    return;
                                }
                                postModalTitle.textContent = post.title;
                                postModalContent.textContent = post.content;
                                postModalImage.src = post.imageUrl;
                                postModal.style.display = 'flex';
                            });
                        });

                        // Initial animation for blog and latest posts
                        animateCards('blog-posts-container');
                        animateCards('latest-posts-container');
                    }

                    // Initial fetch and real-time subscription for posts
                    supabaseClient.from('posts').select('*').order('created_at', { ascending: false }).then(({ data }) => renderPosts(data));
                    supabaseClient.channel('public:posts').on('postgres_changes', { event: '*', schema: 'public', table: 'posts' }, () => {
                        supabaseClient.from('posts').select('*').order('created_at', { ascending: false }).then(({ data }) => renderPosts(data));
                    }).subscribe();

                    // --- File Upload Logic ---
                    // Handle new file upload form submission
                    uploadFileForm.addEventListener('submit', async (e) => {
                        e.preventDefault();
                        if (!currentUser || currentUser.email !== ADMIN_EMAIL) {
                            showMessage("You are not authorized to upload files.");
                            return;
                        }
                        const title = fileTitleInput.value;
                        const file = fileUploadInput.files[0];
                        if (!file || !title) return;

                        // Generate a unique file path for Supabase Storage
                        const filePath = `public/${Date.now()}_${file.name}`;
                        const { error: uploadError } = await supabaseClient.storage.from('market-files').upload(filePath, file);

                        if (uploadError) {
                            console.error('Upload Error:', uploadError);
                            showMessage('Error uploading file: ' + uploadError.message);
                            return;
                        }

                        // Get the public URL for the uploaded file
                        const { data: { publicUrl } } = supabaseClient.storage.from('market-files').getPublicUrl(filePath);

                        // Insert the file's metadata (title and URL) into the database
                        const { error: dbError } = await supabaseClient.from('marketfiles').insert([{ title, downloadURL: publicUrl, filePath: filePath }]);

                        if (dbError) console.error("Error adding file link:", dbError);
                        else uploadFileForm.reset();
                    });

                    // Renders market files and manages the UI for all file-related sections
                    function renderFiles(files) {
                        let marketFilesHtml = '', manageFilesHtml = '', latestFilesHtml = '';
                        if (!files || files.length === 0) {
                            marketFilesHtml = `<p class="text-center col-span-full text-text-muted">No market files available yet.</p>`;
                            manageFilesHtml = `<p class="text-center text-text-muted">No files to manage.</p>`;
                            latestFilesHtml = `<p class="text-center col-span-full text-text-muted">No latest files yet.</p>`;
                        } else {
                            // Render latest files on the homepage
                            const latestFiles = files.slice(0, 5);
                            latestFiles.forEach(file => {
                                latestFilesHtml += `<a href="${file.downloadURL}" target="_blank" class="block w-64 flex-shrink-0 card card-light-hover rounded-2xl overflow-hidden">
                                    <div class="w-full h-32 bg-gray-800 flex items-center justify-center"><i class="fas fa-file-alt fa-3x text-text-muted"></i></div>
                                    <div class="p-4"><h4 class="text-md font-bold text-accent truncate">${file.title}</h4></div>
                                </a>`;
                            });

                            // Render all files on the markets page and admin manage page
                            files.forEach(file => {
                                marketFilesHtml += `
                                    <div class="card p-6 rounded-2xl flex flex-col text-center border-glass">
                                        <h3 class="text-xl font-bold text-accent mb-4">${file.title}</h3>
                                        <div class="w-full h-64 bg-gray-800 flex items-center justify-center rounded-xl mb-4"><i class="fas fa-file-alt fa-5x text-text-muted"></i></div>
                                        <a href="${file.downloadURL}" target="_blank" class="btn-glass font-bold py-2 px-6 rounded-xl mt-auto">Download</a>
                                    </div>`;
                                manageFilesHtml += `
                                    <div class="card p-4 rounded-2xl flex justify-between items-center border-glass">
                                        <span class="truncate pr-4">${file.title}</span>
                                        <button data-id="${file.id}" data-path="${file.filePath}" class="delete-file-btn text-delete hover:text-accent font-bold">Delete</button>
                                    </div>`;
                            });
                        }
                        marketFilesContainer.innerHTML = marketFilesHtml;
                        manageFilesContainer.innerHTML = manageFilesHtml;
                        latestFilesContainer.innerHTML = latestFilesHtml;

                        // Add event listeners for the delete file buttons
                        document.querySelectorAll('.delete-file-btn').forEach(button => {
                            button.addEventListener('click', async (e) => {
                                const confirmDelete = await showMessage("Are you sure you want to delete this file?", true);
                                if (confirmDelete) {
                                    const docId = e.target.dataset.id;
                                    const path = e.target.dataset.path;

                                    // Delete from Supabase Storage first
                                    const { error: storageError } = await supabaseClient.storage.from('market-files').remove([path]);
                                    if (storageError) console.error("Error deleting file from storage:", storageError);

                                    // Delete the record from the database
                                    const { error: dbError } = await supabaseClient.from('marketfiles').delete().match({ id: docId });
                                    if (dbError) console.error("Error deleting file record:", dbError);
                                }
                            });
                        });

                        // Initial animation for market files
                        animateCards('market-files-container');
                        animateCards('latest-files-container');
                    }

                    // Initial fetch and real-time subscription for market files
                    supabaseClient.from('marketfiles').select('*').order('created_at', { ascending: false }).then(({ data }) => renderFiles(data));
                    supabaseClient.channel('public:marketfiles').on('postgres_changes', { event: '*', schema: 'public', table: 'marketfiles' }, () => {
                        supabaseClient.from('marketfiles').select('*').order('created_at', { ascending: false }).then(({ data }) => renderFiles(data));
                    }).subscribe();

                } catch (error) {
                    console.error("Critical Supabase Initialization Error:", error);
                    document.body.innerHTML = `<div class="text-text-light text-center p-8">Could not connect to the server. Please check your connection and try again.</div>`;
                }
            }

            // --- Run Initializers ---
            initializeUI();
            initializeSupabase();
        });
    </script>
</body>
</html>
